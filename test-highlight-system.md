# 最终高亮集系统测试指南

## 核心概念验证

### 1. 高亮集合定义测试
- **筛选高亮集 (Filter Highlight Set)**: 通过HyD Code筛选器自动匹配的构件
- **手动高亮集 (Manual Highlight Set)**: 用户点击BIM视图构件手动选择的构件
- **最终高亮集 (Final Highlight Set)**: 两个集合的并集

### 2. 列表筛选优先级测试
- RISC表单和文件列表应仅根据"最终高亮集"筛选
- 验证当有筛选高亮+手动高亮时，列表显示两者关联的所有条目

## 测试场景

### 场景1: HyD Code筛选器变更重置规则
**操作步骤:**
1. 设置任何HyD Code筛选条件（如contractor: CSG）
2. 手动点击BIM视图中的构件
3. 修改HyD Code筛选条件

**预期结果:**
- 手动高亮集被清空
- 新的筛选高亮集根据新条件生成
- 列表内容更新为仅显示新筛选条件相关的项目

### 场景2: 筛选模式下列表点击退出确认
**操作步骤:**
1. 设置HyD Code筛选条件
2. 点击左侧RISC表单或右侧文件列表中的任意条目

**预期结果:**
- 弹出确认框："是否要退出当前的HyD Code筛选..."
- 选择"确定": 清除筛选，建立新的手动高亮集，更新视图
- 选择"取消": 保持当前状态不变

### 场景3: BIM视图构件点击修改手动高亮集
**操作步骤:**
1. 在有HyD Code筛选的情况下，点击BIM视图中的构件
2. 点击已在手动高亮集中的构件

**预期结果:**
- 未在手动高亮集中: 添加到手动高亮集，更新视图和列表
- 已在手动高亮集中: 从手动高亮集移除，更新视图和列表

### 场景4: 手动退出HyD Code筛选
**操作步骤:**
1. 设置HyD Code筛选条件
2. 手动点击BIM视图构件添加到手动高亮集
3. 使用"清除"按钮清空HyD Code筛选

**预期结果:**
- 筛选高亮集被清空
- 手动高亮集保持不变
- 视图中仅显示手动高亮集中的构件为蓝色

### 场景5: 颜色与可见性验证
**操作步骤:**
1. 验证所有构件始终可见
2. 验证蓝色用于最终高亮集中的构件
3. 鼠标悬浮列表条目时验证黄色临时高亮

**预期结果:**
- 无持续高亮时: 悬浮显示蓝色临时高亮
- 有持续高亮时: 悬浮显示黄色临时高亮，覆盖蓝色

## 状态指示器验证

### BIM视图构件状态指示器
- 深蓝色圆点: HyD Code筛选
- 浅蓝色圆点: 手动选中
- 绿色圆点: 在绑定购物车中
- 黄色/蓝色圆点: 悬浮高光

### 统计信息验证
- HyD Code筛选区域显示: "匹配构件: X" 和 "(最终高亮: Y)"
- BIM视图底部显示各种统计信息

## 交互流程验证

### 完整交互流程测试
1. 启动无筛选状态
2. 设置HyD Code筛选 → 验证筛选高亮集
3. 手动点击构件 → 验证手动高亮集
4. 点击列表条目 → 验证退出确认流程
5. 清除筛选 → 验证手动高亮集保留
6. 悬浮交互 → 验证临时高亮效果

每个步骤都应该按照定义的规则正确工作，确保"最终高亮集"概念得到完整实现。 